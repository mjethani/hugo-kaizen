/* Copyright (c) 2025 Manish Jethani */

@layer {
  @layer tokens {
    :root {
      --background-color: #fdfdfd;
      --color: #111;
      --font-family: Palatino, 'Palatino Linotype', 'Book Antiqua', 'Noto Serif', 'DejaVu Serif', serif;
      --font-size: 1rem;
      --font-weight: 400;
      --max-inline-size: 30rem;
      --writing-mode: horizontal-tb;
    }
  }

  @layer base {
    *, ::before, ::after {
      box-sizing: border-box;
    }

    :root {
      font-family: var(--font-family);
      font-size: var(--font-size);
      font-weight: var(--font-weight);
      writing-mode: var(--writing-mode);
    }

    body {
      background-color: var(--background-color);
      color: var(--color);
    }
  }

  @layer typography {
    body {
      line-height: 1.618;
    }

    a {
      color: var(--color);
      text-decoration: underline;
      text-decoration-style: dotted;
      text-underline-offset: 0.236em;
    }

    strong {
      font-weight: 600;
    }

    h1, h2, h3, h4, h5, h6 {
      font-weight: 600;
      line-height: 1.272;
      margin: 0;
      margin-block-end: 1rem;
      margin-block-start: 1.618rem;
    }

    h1 {
      font-size: 2.058rem;
    }

    h2 {
      font-size: 1.618rem;
    }

    h3 {
      font-size: 1.272rem;
    }

    h4, h5, h6 {
      font-size: 1rem;
    }

    p {
      margin: 0;
      margin-block-end: 1rem;
    }

    ul, ol {
      margin: 0;
      margin-block-end: 1rem;
      margin-inline-start: 1.618rem;
      padding: 0;
    }

    li + li {
      margin-block-start: 0.382rem;
    }

    main > section > ul {
      list-style: none;
      margin-inline-start: 0;
    }

    main > section > ul > li::before {
      content: '→';
      margin-inline-end: 0.486rem;
    }
    [dir=rtl] main > section > ul > li::before {
      content: '←';
    }

    pre {
      border-radius: 0.486rem;
      font-size: 0.786rem;
      margin: auto;
      margin-block: 1.618rem;
      padding: 0.618rem;
      white-space: pre-wrap;
      word-break: break-word;
    }

    :not(pre) > code {
      font-size: 0.786rem;
    }

    img {
      display: block;
      block-size: auto;
      margin: auto;
      margin-block: 1.618rem;
      max-inline-size: 100%;
    }

    figure {
      display: flex;
      flex-direction: column;
      gap: 0.618rem;
      margin: auto;
      margin-block: 1.618rem;
    }

    figure > * {
      margin: 0;
    }

    figure > figcaption {
      font-size: 0.786rem;
    }

    blockquote {
      border-inline-start: 0.115rem solid color-mix(in srgb, var(--color) 23.6%, transparent);
      color: color-mix(in srgb, var(--color) 78.6%, transparent);
      margin: auto;
      margin-block: 1.618rem;
      padding: 0;
      padding-inline-start: 1rem;
    }

    blockquote > footer {
      font-size: 0.786rem;
    }

    blockquote > footer > cite:only-child {
      display: flex;
      font-style: normal;
    }

    blockquote > footer > cite:only-child::before {
      content: '―';
      margin-inline-end: 0.236rem;
    }

    table {
      border-collapse: collapse;
      font-variant-numeric: tabular-nums;
      margin: 0;
      margin-block: 1.618rem;
      inline-size: 100%;
    }

    caption {
      caption-side: block-end;
      color: color-mix(in srgb, var(--color) 61.8%, transparent);
      font-size: 0.786rem;
      padding-block-start: 0.486rem;
    }

    thead th {
      background-color: color-mix(in srgb, var(--color) 14.6%, transparent);
      text-align: start;
    }

    th, td {
      border-block-end: 0.071rem solid color-mix(in srgb, var(--color) 18.6%, transparent);
      padding-block: 0.486rem;
      padding-inline: 0.618rem;
      vertical-align: top;
    }

    th {
      font-weight: 600;
      white-space: nowrap;
    }

    tbody tr:nth-child(odd) {
      background-color: color-mix(in srgb, var(--color) 5.6%, transparent);
    }

    tbody tr:hover {
      background-color: color-mix(in srgb, var(--color) 11.5%, transparent);
    }

    th[scope=row] {
      text-align: start;
    }

    td > :first-child, th > :first-child {
      margin-block-start: 0;
    }

    td > :last-child, th > :last-child  {
      margin-block-end: 0;
    }
  }

  @layer layout {
    body {
      align-items: center;
      display: flex;
      flex-direction: column;
      margin: 0;
      margin-inline: 1.272rem;
    }

    body > * {
      max-inline-size: var(--max-inline-size);
      inline-size: 100%;
    }

    body > header {
      display: flex;
      flex-direction: column;
      gap: 2.058rem;
      margin-block-end: 2.058rem;
      margin-block-start: 1rem;
    }

    body > footer {
      margin-block-start: 1.618rem;
      margin-block-end: 1rem;
    }

    .menu {
      order: -1;
    }

    main > :first-child {
      margin-trim: block-start;
    }

    main > :last-child {
      margin-trim: block-end;
    }

    main > :only-child {
      margin-trim: block;
    }

    @supports not (margin-trim: block) {
      main > :first-child > :first-child,
      main > :first-child > :first-child > :first-child,
      main > :first-child > :first-child > :first-child > :first-child {
        margin-block-start: 0;
      }

      main > :last-child > :last-child,
      main > :last-child > :last-child > :last-child,
      main > :last-child > :last-child > :last-child > :last-child {
        margin-block-end: 0;
      }
    }

    main > article > header {
      margin-block-end: 2.058rem;
    }
  }

  @layer components {
    .copyright {
      font-size: 0.786rem;
      font-weight: 300;
      margin: 0;
      text-align: center;
    }

    .title {
      font-size: 1.272rem;
      font-weight: 500;
      letter-spacing: 0.236rem;
      line-height: 1;
      margin: 0;
      text-transform: uppercase;
      inline-size: 100%;
    }

    html:not(.home-kind) .title {
      font-size: 0.786rem;
    }

    .menu nav ul {
      display: flex;
      font-weight: 300;
      font-size: 0.786rem;
      gap: 1rem;
      list-style: none;
      margin: 0;
      padding: 0;
    }

    .menu nav ul > li {
      display: inline-flex;
      line-height: 1;
      margin: 0;
      padding: 0;
    }

    .menu nav ul > li:has(> a[href^='/'])::before {
      content: '/';
      margin-inline-end: 0.236rem;
    }
    [dir=rtl] .menu nav ul > li:has(> a[href^='/'])::before {
      content: '\\';
    }

    .menu nav ul > li:not(:has(> a[href^='/']))::before {
      content: '•';
      margin-inline-end: 0.236rem;
    }

    .more-link {
      line-height: 1;
      margin: 0;
      margin-block-end: 1rem;
    }

    .more-link a {
      text-decoration: none;
    }

    .article-title {
      font-size: 2.618rem;
      font-weight: 500;
      margin-block-start: 0;
    }

    .article-date {
      display: block;
      font-size: 0.786rem;
      font-weight: 300;
      margin: 0;
      margin-block-end: 1rem;
    }

    .article-tags > div > div {
      display: none;
    }

    .article-tags ul {
      color: color-mix(in srgb, var(--color) 78.6%, transparent);
      display: flex;
      flex-wrap: wrap;
      gap: 0.618rem 1rem;
      list-style: none;
      margin: 0;
      margin-block-start: 1.618rem;
      padding: 0;
    }

    .article-tags ul > li {
      display: inline-flex;
      line-height: 1;
      margin: 0;
      padding: 0;
    }

    .article-tags ul > li a::before {
      content: '#';
    }
  }

  @layer utilities {
    .num {
      text-align: start;
    }

    .nowrap {
      white-space: nowrap;
    }
  }

  @layer theme {
    @media (prefers-color-scheme: dark) {
      :root {
        --background-color: #1c1b1a;
        --color: #e8e6e3;
      }
    }

    pre {
      background-color: #272822;
      color: #f8f8f2;
    }

    @media (prefers-color-scheme: dark) {
      pre {
        background-color: #282828;
        color: #ebdbb2;
      }
    }
  }
}
